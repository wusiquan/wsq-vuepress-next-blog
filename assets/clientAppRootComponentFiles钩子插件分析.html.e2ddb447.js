import{_ as s,o as n,c as l,e as a}from"./app.08d597d0.js";const p={},e=a(`<h1 id="clientapprootcomponentfiles\u94A9\u5B50\u63D2\u4EF6\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#clientapprootcomponentfiles\u94A9\u5B50\u63D2\u4EF6\u5206\u6790" aria-hidden="true">#</a> clientAppRootComponentFiles\u94A9\u5B50\u63D2\u4EF6\u5206\u6790</h1><p>@vuepress/core/app</p><p>resolveThemeInfo\u4F1A\u8C03\u7528resolveTheme(app, themeName)</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">resolveThemeInfo</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> (</span><span style="color:#FFB86C;font-style:italic;">app</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">themeName</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// resolve current theme info</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> theme </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">resolveTheme</span><span style="color:#F6F6F4;">(app, themeName)</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> themeInfo </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    layouts</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">resolveThemeLayouts</span><span style="color:#F6F6F4;">(theme.layouts),</span></span>
<span class="line"><span style="color:#F6F6F4;">    plugins</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [theme, </span><span style="color:#F286C4;">...</span><span style="color:#62E884;">resolvePluginsFromConfig</span><span style="color:#F6F6F4;">(app, theme.plugins)],</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>resolveTheme\u5185\u8C03\u7528resolvePlugin\u65B9\u6CD5, resolvePlugin(app, themeEntry, app.options.themeConfig) \u5176\u4E2DthemeEntry\u503C\u8FD9\u91CC\u662F@vuepress/theme-default/lib/node/index\uFF0CdefaultTheme\u5BFC\u51FA\u5982\u4E0B</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">defaultTheme</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Theme</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">DefaultThemeOptions</span><span style="color:#F6F6F4;">&gt; </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> ({</span></span>
<span class="line"><span style="color:#F6F6F4;">  themePlugins </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> {},</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">...</span><span style="color:#F6F6F4;">localeOptions</span></span>
<span class="line"><span style="color:#F6F6F4;">}) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">@vuepress/theme-default</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    plugins</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [</span></span>
<span class="line"><span style="color:#F6F6F4;">      [</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">@vuepress/back-to-top</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, themePlugins.backToTop </span><span style="color:#F286C4;">!==</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">],</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F6F6F4;">    ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>resolvePlugin\u65B9\u6CD5\u53D1\u73B0\u5176\u662F\u4E00\u4E2A\u51FD\u6570\u7C7B\u578B\uFF0C\u4F1A\u8C03\u7528pluginModule(config, app)\uFF0C\u8FD4\u56DE\u5230resolveThemeInfo\u65B9\u6CD5\uFF0C\u8C03\u7528resolvePluginsFromConfig(app, theme.plugins)\uFF0C\u5B83\u4F1A\u904D\u5386plugins\u8C03\u7528resolvePlugin(app, plugin, config === true ? {} : config)\uFF0C\u8FD9\u91CCplugin\u53C2\u6570\u503C\u4E3A&#39;@vuepress/back-to-top&#39;, config\u53C2\u6570\u503C\u4E3A\u8868\u8FBE\u5F0F<code>themePlugins.backToTop !== false</code>\u7684\u503C\uFF0C\u540C\u6837resolvePlugin\u65B9\u6CD5\u53D1\u73B0@vuepress/plugin-back-to-top\u5BFC\u51FA\u662F\u4E00\u4E2A\u51FD\u6570\u7C7B\u578B\uFF0C\u4F1A\u8C03\u7528pluginModule(config, app)</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">backToTopPlugin</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Plugin</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">BackToTopPluginOptions</span><span style="color:#F6F6F4;">&gt; </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> (</span><span style="color:#FFB86C;font-style:italic;">_</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">app</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (app.env.isDev </span><span style="color:#F286C4;">&amp;&amp;</span><span style="color:#F6F6F4;"> app.options.bundler.</span><span style="color:#62E884;">endsWith</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">vite</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">)) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// eslint-disable-next-line import/no-extraneous-dependencies</span></span>
<span class="line"><span style="color:#F6F6F4;">    app.options.bundlerConfig.viteOptions </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">require</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">vite</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">).</span><span style="color:#62E884;">mergeConfig</span><span style="color:#F6F6F4;">(</span></span>
<span class="line"><span style="color:#F6F6F4;">      app.options.bundlerConfig.viteOptions,</span></span>
<span class="line"><span style="color:#F6F6F4;">      {</span></span>
<span class="line"><span style="color:#F6F6F4;">        optimizeDeps</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">          exclude</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">ts-debounce</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">],</span></span>
<span class="line"><span style="color:#F6F6F4;">        },</span></span>
<span class="line"><span style="color:#F6F6F4;">      }</span></span>
<span class="line"><span style="color:#F6F6F4;">    )</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">@vuepress/plugin-back-to-top</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    clientAppRootComponentFiles</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> path.</span><span style="color:#62E884;">resolve</span><span style="color:#F6F6F4;">(</span></span>
<span class="line"><span style="color:#F6F6F4;">      __dirname,</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">../client/components/BackToTop.js</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"><span style="color:#F6F6F4;">    ),</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728@vuepress/cli/commands/dev/createDev\u8C03\u7528app.init() \u5373@vuepress/core/app/appInit, \u5185\u90E8\u8C03\u7528app.pluginApi.registerHooks()</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#7B7F8B;">/**</span></span>
<span class="line"><span style="color:#7B7F8B;"> * Initialize a vuepress app</span></span>
<span class="line"><span style="color:#7B7F8B;"> *</span></span>
<span class="line"><span style="color:#7B7F8B;"> * Plugins should be used before initialization.</span></span>
<span class="line"><span style="color:#7B7F8B;"> */</span></span>
<span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">appInit</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">async</span><span style="color:#F6F6F4;"> (</span><span style="color:#FFB86C;font-style:italic;">app</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">App</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Promise</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;">&gt; </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// register all hooks of plugins that have been used</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// plugins should be used before \`registerHooks()\`</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// hooks in plugins will take effect after \`registerHooks()\`</span></span>
<span class="line"><span style="color:#F6F6F4;">  app.pluginApi.</span><span style="color:#62E884;">registerHooks</span><span style="color:#F6F6F4;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>@vuepress/core/pluginApi/createPluginApiRegisterHooks\u4E2D\u7684\u5185\u90E8\u51FD\u6570, \u6253\u5370\u53EF\u770B\u5230plugins\u6570\u7EC4\u4E2D\u7684\u5BF9\u5E94\u9879{name: &#39;@vuepress/plugin-back-to-top&#39;, clientAppRootComponentFiles: &#39;/xxxx/node_modules/@vuepress/plugin-back-to-top/lib/client/components/BackToTop.js&#39;} \u8FD9\u91CCnormalizeClientFilesHook\u662F\u4E2A\u9AD8\u9636\u51FD\u6570, \u5B9E\u9645\u5C31\u662F\u5BF9plugin-back-to-top\u63D2\u4EF6node\u5BFC\u51FA\u7684clientAppRootComponentFiles\u8DEF\u5F84/xxx/node_modules/@vuepress/plugin-back-to-top/lib/client/components/BackToTop.js\uFF0C\u6807\u51C6\u5316\u4E3A\u6570\u7EC4\u5F62\u5F0F\uFF0C\u5E76\u68C0\u67E5\u5BF9\u5E94\u6587\u4EF6\u662F\u5426\u5B58\u5728</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">createPluginApiRegisterHooks</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> (</span><span style="color:#FFB86C;font-style:italic;">plugins</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">hooks</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> () </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  plugins.</span><span style="color:#62E884;">forEach</span><span style="color:#F6F6F4;">(({ name: </span><span style="color:#FFB86C;font-style:italic;">pluginName</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">alias</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">define</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">clientAppEnhanceFiles</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">clientAppRootComponentFiles</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">clientAppSetupFiles</span><span style="color:#F6F6F4;">, </span><span style="color:#F286C4;">...</span><span style="color:#FFB86C;font-style:italic;">commonHooks</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (clientAppRootComponentFiles) {</span></span>
<span class="line"><span style="color:#F6F6F4;">      hooks.clientAppRootComponentFiles.</span><span style="color:#62E884;">add</span><span style="color:#F6F6F4;">({</span></span>
<span class="line"><span style="color:#F6F6F4;">        pluginName,</span></span>
<span class="line"><span style="color:#F6F6F4;">        hook</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">normalizeClientFilesHook</span><span style="color:#F6F6F4;">(clientAppRootComponentFiles),</span></span>
<span class="line"><span style="color:#F6F6F4;">      })</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F6F6F4;">  })</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728@vuepress/cli/commands/dev/createDev\u8C03\u7528app.prepare() \u5373@vuepress/core/app/appPrepare, \u5185\u90E8\u8C03\u7528prepareClientAppRootComponents(app)</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#7B7F8B;">// @vuepress/core/app/appPrepare.ts</span></span>
<span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">appPrepare</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">async</span><span style="color:#F6F6F4;"> (</span><span style="color:#FFB86C;font-style:italic;">app</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">App</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Promise</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;">&gt; </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// generate client app root components file</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">await</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">prepareClientAppRootComponents</span><span style="color:#F6F6F4;">(app)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728@vuepress/core/app/prepare/prepareClientAppRootComponents\u4E2Dprocess\uFF0C\u5B9E\u9645\u5C31\u662F\u5BF9\u4E0A\u9762<code>add</code>\u540E\u7684[ { pluginName: &#39;@vuepress/plugin-back-to-top&#39;, hook: [AsyncFunction (anonymous)] } ]\u8FDB\u884C\u5904\u7406\uFF0C\u8FD4\u56DE\u7ED3\u679CclientAppRootComponentFiles\u4E3A[ [ &#39;/xxxx/node_modules/@vuepress/plugin-back-to-top/lib/client/components/BackToTop.js&#39; ] ]</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#7B7F8B;">// @vuepress/core/app/prepare/prepareClientAppRootComponents</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;"> { App } </span><span style="color:#F286C4;">from</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">../../types</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">/**</span></span>
<span class="line"><span style="color:#7B7F8B;"> * Generate client app root components temp file</span></span>
<span class="line"><span style="color:#7B7F8B;"> */</span></span>
<span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">prepareClientAppRootComponents</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">async</span><span style="color:#F6F6F4;"> (</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#FFB86C;font-style:italic;">app</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">App</span></span>
<span class="line"><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Promise</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#97E1F1;font-style:italic;">void</span><span style="color:#F6F6F4;">&gt; </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// plugin hook: clientAppRootComponentFiles</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> clientAppRootComponentFiles </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">await</span><span style="color:#F6F6F4;"> app.pluginApi.hooks.clientAppRootComponentFiles.</span><span style="color:#62E884;">process</span><span style="color:#F6F6F4;">(</span></span>
<span class="line"><span style="color:#F6F6F4;">    app</span></span>
<span class="line"><span style="color:#F6F6F4;">  )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// flat the hook result to get the file paths array</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> filePaths </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> clientAppRootComponentFiles.</span><span style="color:#62E884;">flat</span><span style="color:#F6F6F4;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// generate client app root components files entry</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> content </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">\`</span><span style="color:#F286C4;">\\</span></span>
<span class="line"><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">filePaths</span></span>
<span class="line"><span style="color:#E7EE98;">  </span><span style="color:#F6F6F4;">.</span><span style="color:#62E884;">map</span><span style="color:#F6F6F4;">(</span></span>
<span class="line"><span style="color:#E7EE98;">    (</span><span style="color:#FFB86C;font-style:italic;">filePath</span><span style="color:#E7EE98;">, </span><span style="color:#FFB86C;font-style:italic;">index</span><span style="color:#E7EE98;">) </span><span style="color:#F286C4;">=&gt;</span></span>
<span class="line"><span style="color:#E7EE98;">      </span><span style="color:#E7EE98;">\`import clientAppRootComponent</span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">index</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;"> from &#39;</span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">filePath</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;">&#39;\`</span></span>
<span class="line"><span style="color:#E7EE98;">  </span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#E7EE98;">  </span><span style="color:#F6F6F4;">.</span><span style="color:#62E884;">join</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#F286C4;">\\n</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E7EE98;">export const clientAppRootComponents = [</span></span>
<span class="line"><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">filePaths.</span><span style="color:#62E884;">map</span><span style="color:#F6F6F4;">(</span><span style="color:#E7EE98;">(</span><span style="color:#FFB86C;font-style:italic;">_</span><span style="color:#E7EE98;">, </span><span style="color:#FFB86C;font-style:italic;">index</span><span style="color:#E7EE98;">) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#E7EE98;"> </span><span style="color:#E7EE98;">\`  clientAppRootComponent</span><span style="color:#F286C4;">\${</span><span style="color:#F6F6F4;">index</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;">,\`</span><span style="color:#F6F6F4;">).</span><span style="color:#62E884;">join</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#F286C4;">\\n</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">}</span></span>
<span class="line"><span style="color:#E7EE98;">]</span></span>
<span class="line"><span style="color:#E7EE98;">\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">await</span><span style="color:#F6F6F4;"> app.</span><span style="color:#62E884;">writeTemp</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">internal/clientAppRootComponents.js</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">, content)</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6240\u4EE5\u4F1A\u5199\u5165.temp/internal/clientAppRootComponents.js</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> clientAppRootComponent0 </span><span style="color:#F286C4;">from</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">/xxx/node_modules/@vuepress/plugin-back-to-top/lib/client/components/BackToTop.js</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> clientAppRootComponents </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> [</span></span>
<span class="line"><span style="color:#F6F6F4;">  clientAppRootComponent0,</span></span>
<span class="line"><span style="color:#F6F6F4;">]</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728@vuepress/client/app\u4E2D\u53EF\u4EE5\u770B\u5230\u4F7F\u7528\u5168\u5C40\u7EC4\u4EF6clientAppRootComponents</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#282A36;"><code><span class="line"><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> { clientAppRootComponents } </span><span style="color:#F286C4;">from</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">@internal/clientAppRootComponents</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> { createApp, createSSRApp, h } </span><span style="color:#F286C4;">from</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">vue</span><span style="color:#DEE492;">&#39;</span></span>
<span class="line"><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">createVueApp</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">CreateVueAppFunction</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">async</span><span style="color:#F6F6F4;"> () </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// create vue app</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> app </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">appCreator</span><span style="color:#F6F6F4;">({</span></span>
<span class="line"><span style="color:#F6F6F4;">    name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">VuepressApp</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#62E884;">setup</span><span style="color:#F6F6F4;">() {</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> () </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> [</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#62E884;">h</span><span style="color:#F6F6F4;">(RouterView),</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">...</span><span style="color:#F6F6F4;">clientAppRootComponents.</span><span style="color:#62E884;">map</span><span style="color:#F6F6F4;">((</span><span style="color:#FFB86C;font-style:italic;">comp</span><span style="color:#F6F6F4;">) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">h</span><span style="color:#F6F6F4;">(comp)),</span></span>
<span class="line"><span style="color:#F6F6F4;">      ]</span></span>
<span class="line"><span style="color:#F6F6F4;">    },</span></span>
<span class="line"><span style="color:#F6F6F4;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    app,</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// router,</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">// mount app in client bundle</span></span>
<span class="line"><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (</span><span style="color:#F286C4;">!</span><span style="color:#F6F6F4;">_<wbr>_VUEPRESS_SSR__) {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#62E884;">createVueApp</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">then</span><span style="color:#F6F6F4;">(({ </span><span style="color:#FFB86C;font-style:italic;">app</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">router</span><span style="color:#F6F6F4;"> }) </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">    router.</span><span style="color:#62E884;">isReady</span><span style="color:#F6F6F4;">().</span><span style="color:#62E884;">then</span><span style="color:#F6F6F4;">(() </span><span style="color:#F286C4;">=&gt;</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">      app.</span><span style="color:#62E884;">mount</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&#39;</span><span style="color:#E7EE98;">#app</span><span style="color:#DEE492;">&#39;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    })</span></span>
<span class="line"><span style="color:#F6F6F4;">  })</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,20),o=[e];function c(t,F){return n(),l("div",null,o)}var r=s(p,[["render",c],["__file","clientAppRootComponentFiles\u94A9\u5B50\u63D2\u4EF6\u5206\u6790.html.vue"]]);export{r as default};
